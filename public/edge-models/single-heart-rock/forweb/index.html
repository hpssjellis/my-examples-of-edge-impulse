<!DOCTYPE html>
<html lang="en">


<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.8.0"> </script> 

 

<h5>    Version   0.1.3   </h5>
LOAD URL <input id="myInFile" type="text" size="120" value="https://hpssjellis.github.io/my-examples-of-edge-impulse/public/edge-models/single-heart-rock/forweb/model.json"><br>  


<img id="myLoadImage" width = 200 src="coffee.jpg"/>



 
<input id="myButton4950" type="button" value="Load everything from a URL and test the data" onclick="{

  const startTime = performance.now();
  document.getElementById('myDiv4950').innerHTML = '<br>'
  document.getElementById('myButton4950').style.backgroundColor = 'red'  
                                                                                                                                                        
  async function myGo6() {
			


const model = await tf.loadGraphModel(
    'https://tfhub.dev/google/tfjs-model/imagenet/mobilenet_v3_small_100_224/feature_vector/5/default/1',
    { fromTFHub: true });


function preprocess(imageTensor) {
  const widthToHeight = imageTensor.shape[1] / imageTensor.shape[0];
  let squareCrop;
  if (widthToHeight > 1) {
    const heightToWidth = imageTensor.shape[0] / imageTensor.shape[1];
    const cropTop = (1-heightToWidth) / 2;
    const cropBottom = 1 - cropTop;
    squareCrop = [[cropTop, 0, cropBottom, 1]];
  } else {
    const cropLeft = (1-widthToHeight) / 2;
    const cropRight = 1 - cropLeft;
    squareCrop = [[0, cropLeft, 1, cropRight]];
  }
  // Expand image input dimensions to add a batch dimension of size 1.
  const crop = tf.image.cropAndResize(
      tf.expandDims(imageTensor), squareCrop, [0], [224, 224]);
  return crop.div(255);
}

const image = document.getElementById('myLoadImage');
							
const imageTensor = tf.browser.fromPixels(image);
const predictions = model.predict(preprocess(imageTensor));
    console.log('predictions');
    console.log(predictions);	
												     
												     
												     
												     
    // Classify the image.
   // const predictions = await model.classify(imageTensor);
    document.getElementById('myDiv4950').innerHTML = 'Predictions: Probability, Class Names<br>' + 
      predictions[0].probability + ', '+ predictions[0].className +'<br>' + 
      predictions[1].probability + ', '+ predictions[1].className +'<br>' + 
      predictions[2].probability + ', '+ predictions[2].className +'<br>' +
      'See console for other info'


    // Get the logits.
    const logits = model.infer(imageTensor);
    console.log('Logits');
    logits.print(true);

    // Get the embedding.
    const embedding = model.infer(imageTensor, true);
    console.log('Embedding');
    embedding.print(true);												     
												     
												     
												     
												     
												     
												     
												     
											  
    document.getElementById('myButton4950').style.backgroundColor = 'lightgrey'                    
  }

  setTimeout(function(){  myGo6() }, 10);   // wait a bit for the GUI to update	
}" style="background-color: red;">
	
	
	<br><br>

<div id='myDiv4950'>...</div><br>

	
</html>
